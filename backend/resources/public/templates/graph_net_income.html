{% extends "public/templates/base.html" %}

{% block content %}


<div id="graph_type" class="container bg-box">
  <button class="flat-button selected" onclick="window.location.href = '/graphs/net-income';">Net income</button>
  <button class="flat-button" onclick="window.location.href = '/graphs/sum-by-tag';">Spending by tag</button>
</div>

{% include "public/templates/year_filter.html" with route="/graphs/net-income/" %}


<div id="graph" class="bg-box" style="width:100%; height:400px;"></div>


<script src="/public/js/highcharts-custom.js" type="text/javascript"></script>
<script src="/public/js/cull.js" type="text/javascript"></script>
<script type="text/javascript">
  var netIncomeByMonthJson = JSON.parse('{{net-income-by-month|json|safe}}');

  var years = JSON.parse('{{years|json|safe}}');


  var jsonToExpenses = function (json) {
    return cull.map(function (obj) {
      return [obj.time, obj.expense * -1];
    }, json);
  };

  var jsonToIncome = function (json) {
    return cull.map(function (obj) {
      return [obj.time, obj.income];
    }, json);
  };

  var chart = new Highcharts.Chart(
          Highcharts.merge(
                  cashFlowChartTheme,
                  {
                    chart: {
                      type: 'column',
                      renderTo: 'graph'
                    },
                    xAxis: {
                      type: 'category'
                    },
                    series: [
                      {
                        name: 'Income',
                        data: jsonToIncome(netIncomeByMonthJson),
                        dataLabels: {
                          enabled: true,
                          color: "#c0c0c0"
                        },
                        color: "#87ba82"
                      },
                      {
                        name: 'Expenses',
                        data: jsonToExpenses(netIncomeByMonthJson),
                        dataLabels: {
                          enabled: true,
                          color: "#c0c0c0"
                        },
                        color: "#ff7472"
                      }
                    ]
                  }));

</script>

{% endblock }